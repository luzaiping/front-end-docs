编译器 (compiler)
======================

## 原理
### 阶段
大多数编译器可以分成三个阶段：解析 (Parsing)、转换 (Transformation) 以及代码生成 (Code Generation)：

1. *解析*是将最初原始的代码转换为一种更抽象的表示 (即 AST)
2. *转换*是将对上面抽象的表示做一些处理，让它能做到编译器期望它做的事情。
3. *代码生成*接收处理之后的代码表示，然后把它转换成新的代码。

### 解析 (parsing)
解析一般会分为两个阶段：词法分析(Lexical Analysis) 和 语法分析(Syntactic Analysis):

1. 词法分析(Lexical Analysis)
接收原始代码，然后把它分割成一些被成为 Token 的东西，这个过程是在词法分析器(Tokenizer 或 Lexer)中完成的。
Token是一个数组，由一些代码语句的碎片组成。它们可以是数字、标签、标点符号、运算符 或者其他任何东西。

1. 语法分析(Syntactic Analysis)
接收之前生成的 Token，把它们转换成一种抽象的表示，这种抽象的表示描述了代码语句中的每一个片段以及它们之间的关系。这种成为中间表示(intermediate representation) 或 抽象语法树 (Abstract Syntax Tree, 即 AST)
抽象语法树是一个嵌套很深的对象，用一种更容易处理的方式代表了代码本身，也能给我们更多信息。

### 转换 (transforming)
编译器的下一步就是转换。它只是把 AST 拿过来然后对它做一些修改。它可以在同种语言下操作 AST，也可以把 AST 翻译成全新的语言。

```js
traverse(ast, visitor)
```

转换的过程是通过 traverse 遍历 AST，遍历每一个节点时需要调用 visitor 中对应的处理函数 (如果存在的话)

### 代码生成 (code generation)
编译器的最后一个阶段是代码生成，这个阶段做的事情有时候会和转换(transformation)重叠，但是代码生成最主要的部分还是根据`AST`来输出代码。

代码生成有几种不同的工作方式，有些编译器将会重用之前生成的 token，有些会创建独立的代码表示，以便于线性地输出代码。

## 用途

### 静态分析 VS 动态分析

静态分析是在不需要执行代码的前提下对代码进行分析的处理过程(执行代码的同时进行代码分析就是动态分析)。静态分析的目的是多种多样的，它可用于语法检查，编译，代码高亮，代码转换，优化，压缩等。

### babel

Babel 是 javascript 编译器，更确切地说是源码到源码的编译器，通常也叫做 "转换编译器(transpiler)"。意思是你为 Babel 提供一些 js 代码，babel 更改这些代码，返回给你新的代码。
